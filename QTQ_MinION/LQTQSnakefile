
'''THIS PIPELINE CHECKS THE LONG-READS RAW DATA FOR THEIR QUALITY,
   TRIMS, AND THEN RE-CHECKS THE QUALITY OF THE TRIMMED DATA'''


configfile: "config.yaml"

rule all:
    input:
        config["Ldatadir"]+"/Nano_Raw-report",
        config["Ldatadir"]+"/Nano_Trimmed-report"

rule nanoq_c:
    input:
        config["Ldatadir"]
    output:
        directory(config["Ldatadir"]+"/Nano_Raw-report")
    params:
        Trimmed = False
    script:
        "nanoqc.py"


rule trimming:
    input:
        config["Ldatadir"]
    output:
        config["Ldatadir"]+"/porechop_output.fastq"
    script:
        "trim_N.py"


rule nanoq_c_t:
    input:
         config["Ldatadir"]+"/porechop_output.fastq"
    output:
         directory(config["Ldatadir"]+"/Nano_Trimmed-report")
    params:
        Trimmed = True
    script:
        "nanoqc.py"
